<!doctype html><html prefix="og: https://ogp.me/ns#" lang=en data-theme=light>
<head>
<meta charset=utf-8>
<title>在Windows上搭建Hugo博客之Github部署填坑记 - My Test Hugo Site</title>
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<title itemprop=name>在Windows上搭建Hugo博客之Github部署填坑记 | My Test Hugo Site</title>
<meta property="og:title" content="在Windows上搭建Hugo博客之Github部署填坑记 | My Test Hugo Site">
<meta name=twitter:title content="在Windows上搭建Hugo博客之Github部署填坑记 | My Test Hugo Site">
<meta itemprop=name content="在Windows上搭建Hugo博客之Github部署填坑记 | My Test Hugo Site">
<meta name=application-name content="在Windows上搭建Hugo博客之Github部署填坑记 | My Test Hugo Site">
<meta property="og:site_name" content="Test">
<meta name=description content="Hello world.">
<meta itemprop=description content="Hello world.">
<meta property="og:description" content="Hello world.">
<meta name=twitter:description content="Hello world.">
<base href=https://chilisan.github.io/2021/02/22/%E5%9C%A8windows%E4%B8%8A%E6%90%AD%E5%BB%BAhugo%E5%8D%9A%E5%AE%A2%E4%B9%8Bgithub%E9%83%A8%E7%BD%B2%E5%A1%AB%E5%9D%91%E8%AE%B0/>
<link rel=canonical href=https://chilisan.github.io/2021/02/22/%E5%9C%A8windows%E4%B8%8A%E6%90%AD%E5%BB%BAhugo%E5%8D%9A%E5%AE%A2%E4%B9%8Bgithub%E9%83%A8%E7%BD%B2%E5%A1%AB%E5%9D%91%E8%AE%B0/ itemprop=url>
<meta name=url content="https://chilisan.github.io/2021/02/22/%E5%9C%A8windows%E4%B8%8A%E6%90%AD%E5%BB%BAhugo%E5%8D%9A%E5%AE%A2%E4%B9%8Bgithub%E9%83%A8%E7%BD%B2%E5%A1%AB%E5%9D%91%E8%AE%B0/">
<meta name=twitter:url content="https://chilisan.github.io/2021/02/22/%E5%9C%A8windows%E4%B8%8A%E6%90%AD%E5%BB%BAhugo%E5%8D%9A%E5%AE%A2%E4%B9%8Bgithub%E9%83%A8%E7%BD%B2%E5%A1%AB%E5%9D%91%E8%AE%B0/">
<meta property="og:url" content="https://chilisan.github.io/2021/02/22/%E5%9C%A8windows%E4%B8%8A%E6%90%AD%E5%BB%BAhugo%E5%8D%9A%E5%AE%A2%E4%B9%8Bgithub%E9%83%A8%E7%BD%B2%E5%A1%AB%E5%9D%91%E8%AE%B0/">
<meta property="og:locale" content="en">
<meta name=language content="English">
<meta itemprop=image content="https://chilisan.github.io/images/walking-by.gif">
<meta property="og:image" content="https://chilisan.github.io/images/walking-by.gif">
<meta name=twitter:image content="https://chilisan.github.io/images/walking-by.gif">
<meta name=twitter:image:src content="https://chilisan.github.io/images/walking-by.gif">
<meta property="og:updated_time" content="2021-02-22T03:37:09+0800">
<link rel=sitemap type=application/xml title=Sitemap href=https://chilisan.github.iositemap.xml>
<meta name=robots content="index,follow">
<meta name=googlebot content="index,follow">
<meta name=twitter:site content="@gohugoio">
<meta name=twitter:creator content="@gohugoio">
<link rel="shortcut icon" href=https://chilisan.github.io/favicon.ico>
<link rel=icon type=image/x-icon sizes="16x16 32x32" href=https://chilisan.github.io/favicon.ico>
<meta name=color-scheme content="light, dark">
<link rel=author href=https://chilisan.github.io/humans.txt>
<script>const storage=localStorage.getItem('dark-mode');("dark"===storage||!storage&&window.matchMedia&&window.matchMedia('(prefers-color-scheme: dark)').matches)&&document.documentElement.setAttribute("data-theme","dark")</script>
<script src=https://chilisan.github.io/js/darkm.min.101c6df089d67344a27a3530036dfd436676c000b2a80cb9d9166e4663cb7de2.js></script>
<link rel=stylesheet href=https://chilisan.github.io/css/style.min.66dbc405dfc9db12099abf2e5859c7576c995336824acd94e19376ffe75ca1d4.css>
</head>
<body class=page>
<header class=site-header>
<div class=inner>
<p class="site-title slide-horizontal-invert">
<a href=https://chilisan.github.io/>My Test Hugo Site</a>
</p>
<input type=checkbox id=check-menu class=check-menu hidden>
<label for=check-menu class="nav-btn hide-desktop" aria-label="Open/close menu"><span class=lines></span></label>
<nav class="site-nav hide-mobile slide-horizontal"><svg style="display:none"><symbol viewBox="0 0 24 24" id="moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></symbol><symbol viewBox="0 0 24 24" id="sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></symbol></svg>
<button class="theme__btn light--hidden" aria-label="Enable light mode"><svg aria-hidden="true"><use href="#sun"/></svg></button>
<button class="theme__btn dark--hidden" aria-label="Enable dark mode"><svg aria-hidden="true"><use href="#moon"/></svg></button>
<ul class=site-menu>
<li>
<a href=https://chilisan.github.io/>
<span>Home</span>
</a>
</li>
<li>
<a href=https://chilisan.github.io/about/>
<span>About</span>
</a>
</li>
<li>
<a href=https://chilisan.github.io/posts/>
<span>Archives</span>
</a>
</li>
</ul>
</nav>
</div>
</header>
<main class=site-main>
<article>
<header class=subheader style=background-image:url(images/walking-by.gif)>
<div class="title-container slide-invert">
<h1 class=post-title>在Windows上搭建Hugo博客之Github部署填坑记</h1>
</div>
</header>
<div class="content slide-invert">
<p>这篇博文记录了本CS菜鸟搭建Hugo博客的崎岖过程，内容涵盖以下方面：</p>
<ol>
<li>Hugo在Windows 10系统上的下载与安装（简略说明）</li>
<li>Hugo主题的下载、安装与配置（简略说明）</li>
<li>将Hugo从本地部署到Github个人页面</li>
<li>发布、修改、删除博文</li>
<li>将Github默认的个人页面URL修改为自定义二级域名</li>
</ol>
<p><strong>正式阅读正文前您需要了解，本人在 CS方面完完全全就是菜鸟一只。到底有多菜鸟呢？在 Hugo的部署过程中需要大量git操作，而我是因为要建 Hugo才开始学习git的基础操作。这篇博文算是我在自建Hugo博客过程中各路乱抄的作业答案整理归纳，抄作业过程中，我由于不明原理而抄错答案，导致博客运行出现了很多问题，这篇博文也对这些错误、错误原因和解决方式进行了总结。博文中可能难免出现描述性错误或可以进一步完善的地方，如有修改建议，希望您可以在下方评论指正，或通过fediverse账号、邮箱联系我修改。</strong></p>
<h2 id=一hugo在windows-10系统上的下载与安装>一、Hugo在Windows 10系统上的下载与安装</h2>
<p>Hugo的官方网站上有Hugo在各种系统上安装的详细说明视频，对于熟悉Window 10系统操作的朋友来说并不困难，这里不再做复述和进一步说明，详情请看 <a href=https://gohugo.io/getting-started/installing/>Hugo-Getting Started-Install Hugo</a> 。</p>
<p>按照视频下载安装后，您的计算机中应该有一个名为"Hugo"的目录、一个名为"Sites"的用于存放所有博客站点的目录，Hugo目录下应有三个文件；同时，您的计算中应已下载Git程序。</p>
<h2 id=二hugo主题的下载安装与配置>二、Hugo主题的下载、安装与配置</h2>
<p>这部分内容在网络上可以搜索到很多指南，我在操作过程中也遇到没什么问题，也不再进行详细说明。大致有这几个步骤：创建博客、下载安装主题、主题配置、本地测试，完成这部分操作后，您应该已经可以通过 <a href=http://localhost:1313/>http://localhost:1313/</a> 查看您选择的主题成功安装在Hugo博客上的样子了。</p>
<p>因为每个主题的配置文件、目录都略有不同，在主题配置过程中的具体操作请参考每个主题的说明文档。我的博客选用的主题是<a href=https://themes.gohugo.io/hugo-tranquilpeak-theme/>tranquilpeak</a>。</p>
<p>此时您的博客目录下应该有已经配置完毕的config.toml文件，themes目录下存放着您已经安装完毕的主题。一般这个主题目录不做改动，除非您是主题设计者，对主体魔改有强烈的需求。tranquilpeak主题目录中有一个名为"exampleSite"的目录，将目录下的所有目录与文件复制粘贴到博客根目录下并覆盖原有的目录、文件，通常主题应该都有类似exampleSite的目录，普通的主题调整一般只需在config.toml文件与static目录中进行。</p>
<p>我建议您主题下载完成后在本地其他的目录再保存一份主题文档。在我自己搭建博客的过程中，混乱的窗口、git操作失误导致我的博客目录混乱不堪，不得不将整个目录删除重建，通过Hugo下载主题，速度可能由于众所周知的网络原因而变得十分缓慢（尽管主题文件往往并不大）。（假如您不幸和我一样需要重建博客，）将备份的主题目录直接粘贴到博客目录下会大大减少您的博客搭建测试时间。</p>
<h2 id=三将hugo从本地部署到github个人页面>三、将Hugo从本地部署到Github个人页面</h2>
<p>这部分是我自己踩坑最多的地方，其实直到现在，我也没有完全弄清楚这一步怎么做是最好的或最适合自己的，所以在我把git基础教程看完并再去整理之前看过的各个教程后，这部分内容应该会再做修改更新。</p>
<p>Hugo部署到Github似乎有两种方式：</p>
<ul>
<li>创建两个repository，一个存放hugo博客源文件，一个存放个人博客public中的文件</li>
<li>创建一个repository和两个分支，分支分别存放源文件与public目录下的文件（也可创建一个分支，将public目录下文件存放进/doc）</li>
</ul>
<p>但是大多数教程在这部分说得比较模糊，按照一般的教程，教程仅让你创建一个gh-pages的repository（即<user>.github.io，<user>替换为github账户用户名）。这部分在网上也能找到很多教程，同样不过多阐释。目前我的博客也是在仅使用默认分支master与一个repository的情况下建立起来的，并没有上传源文件，这样大概是没办法使用github actions（自动部署工具）的，不过目前并不影响我正常使用。</p>
<p>特别提醒两点：</p>
<p>第一，创建repository完毕后，请在您的repository页面上方找到Settings，点击进入，在下方找到添加主题按钮为你的github页面添加一个主题，添加主题后，这个repository下会生成两个新文件：README.md和_config.yml。</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>
hugo

cd public

git add .

git commit -m &#34;xxx(任意内容)&#34;

git remote add origin https://github.com/&lt;user&gt;/&lt;user&gt;.github.io.git

# 这里如果git地址写错误上传，可执行git remote remove origin

git pull origin master  

# 这一步将repository上的两个文件拉到本地，如果今后远程repository中出现变动，需要这一步拉取远程数据，否则无法进行git push

git push -u origin master

</code></pre></div><p>（有一些教程中可能会提示您若git push后报错就用<code>git push -f origin master</code>这个命令，-f 即 &ndash;force ，是强制执行的意思，这个命令会强行删除远程repository中的文件后将本地文件push到远程，不建议使用；如果本地与远程不同步，请尽量使用git pull命令，或使用 <code>git status</code> 寻找的具体问题。）</p>
<p>为什么需要添加主题呢，如果缺少这一步，部署成功后打开你的博客页面可能会出现css、js文件加载失败的问题；除此之外，如果您有自定义域名并让博客域名由http转换为https的需求，这个_comfig.yml文件是必须的。</p>
<p>第二，执行上面的命令过程中可能会出现这个报错：
Git The requested URL returned error:403</p>
<p>出现这个报错有三种可能：</p>
<ol>
<li>您没有权限</li>
<li>您修改过github账户用户名与密码</li>
<li>您曾在电脑上使用过其他github账户</li>
</ol>
<p>我当时出现了两次这个报错，第一次是因为我曾在电脑上安装hexo博客，当时我使用的是另一个github账户，也就是第三种情况。这是您需要打开控制面板->用户账户->管理Windows凭据，向下看有普通凭据，找到关于 <code>git:https://github.com</code> 并删除。 <a href=https://www.cnblogs.com/wangxiaozhang/p/11303557.html>方法来自WANGXIAOZHANG的博文</a></p>
<p>第二次报错是因为我注册的新github账户没有在电脑上使用过，也就是第一种情况，这时您需要<strong>生成SSH添加到GitHub</strong>。</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>
git config --global user.name &lt;username&gt;

git config --global user.email &lt;useremail&#34;&gt;

</code></pre></div><p>根据您的github账户信息替换上面的内容，之后创建SSH：</p>
<p><code>ssh-keygen -t rsa -C &lt;useremail></code></p>
<p>之后输入：</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>
cat ~/.ssh/id_rsa.pub

</code></pre></div><p>将输出结果复制下来，请在您的repository页面上方找到Settings，点击进入并在左边找到SSH and GPG keys，创建SSH keys，Title处可随意填写，在Key处输入刚刚复制的结果，之后保存。</p>
<p>在git bash输入：</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>
ssh -T git@github.com

</code></pre></div><p>输出了你的github用户名即代表SSH添加成功。
第一次在本地使用这个github账户可能跳出新窗口，按照指示输入github用户名、邮箱、密钥等信息即可，之后不会再出现这个窗口。</p>
<p>到现在您可以刷新您的github页面，里面的内容应该已经更新为和本地的public目录下同样的状态，在url栏输入 <user>.github.io 应就该会跳出您的博客页面啦~</p>
<h2 id=四发布修改删除博文>四、发布、修改、删除博文</h2>
<p>添加新博文，在根目录执行命令：</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>
hugo new post/标题.md

</code></pre></div><p>或者直接将markdown文件拖到您主题对应的存放博文的目录下并添加修改前置数据。</p>
<p>在此之前可以先在archetypes目录下添加编辑post.md文件，设置文章模板。这里要根据您安装的主题去编辑，在tranquilpeak主题中，博文默认储存在content/post/中，默认博文样式文件名为post.md，有些主题content下的目录可能为posts，请在您安装的主题目录中的content与archetypes目录中找到正确的格式。</p>
<p>对于tranquilpeak主题，可以这么设置post.md:
(这部分内容来自<a href=https://saquarius.com/2019/07/hugo-github%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2windows10/#%E5%BB%BA%E7%AB%8Bgithub-pages%E5%B9%B6%E5%B0%86%E5%8D%9A%E5%AE%A2%E9%A1%B9%E7%9B%AE%E9%83%A8%E7%BD%B2%E5%88%B0github%E4%B8%8A>SAquarius的梦想屋</a>)</p>
<div class=highlight>e></div><p>除此之外还可以添加：</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>
slug: xxx  
# 标题中含中文时可以利用slug简化url，纯英文标题一般不需要。
# 比如标题&#34;在 Debian 10 / Ubuntu 20.04 上安装 Pleroma（版本：2.2.1）&#34;的默认url会很混乱
# 此时可以在slug后输入&#34;Pleroma-Installation-on-Linux-using-OTP-releases&#34;（注意冒号后的空格）
# 这篇博文的url就会变为&#34;https://suicablog.cobaltkiss.blue/2020/09/pleroma-installation-on-linux-using-otp-releases/&#34;

draft: false  
#false表示这篇博文不是草稿，push后的博文将直接公开出现在播客主页上
# 若设置为true，则代表这篇博文是草稿状态。

</code></pre></div><ul>
<li>发布新博文/修改博文</li>
</ul>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>
hugo
cd public
git add .
git commit -m &#34;new post added(或任意内容)&#34;
git push -u origin master

</code></pre></div><ul>
<li>删除博文</li>
</ul>
<p>在尝试删除博文时，由于我之前不了解git基础操作，误删了连接本地与和远程repository的重要目录".git"，之后便是不断地报错。前往不要直接将public删除，这回将里面的隐藏目录".git"以及之前手动pull的两个文件一并删除（如果之后设置了自定义域名，CNAME文件也会被删除），所以请在删除public中其他文件时保留：</p>
<ul>
<li>
<ul>
<li>.git目录</li>
</ul>
</li>
<li>
<ul>
<li>README.md</li>
</ul>
</li>
<li>
<ul>
<li>_config.yml</li>
</ul>
</li>
<li>
<ul>
<li>CNAME</li>
</ul>
</li>
</ul>
<p>以防万一可以给这几个文件目录做个本地备份）</p>
<p>之后在根目录正常执行：</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>hugo
cd public
git add .
git commit -m &#34;post deleted(或任意内容)&#34;
git push -u origin master
</code></pre></div><h2 id=五将github默认的个人页面url修改为自定义二级域名>五、将Github默认的个人页面URL修改为自定义二级域名</h2>
<p>将博客url弄到二级域名上是个不错的选择，顶级域名则可用作其他用途。
首先您需要先有个自己的域名，关于买域名购买方式这里也不多阐释，国内的域名需要备案，非国内域名则无需备案；之后您需要为域名申请证书，常见的免费证书申请方案是Let&rsquo;s encrypt（三个月后失效，需手动重新申请或添加自动申请certbot），或者您也可以将您的域名绑定到cloudflare上，申请免费的15年根域名与通配符域名证书。</p>
<p>之后，您需要在您的域名购买商那边或者CF的DNS设置界面添加A记录，我的顶级域名已添加A记录到我的服务器IP用作其他用途，这里只需为二级域名添加一条新的A记录，指向下面四个域名中的任意一条：</p>
<pre><code>185.199.108.153
185.199.109.153
185.199.110.153
185.199.111.153
</code></pre>
<p>详细步骤请参考这篇博文：<a href=https://iseex.github.io/2018-08/custom-domain/>GitHub Pages域名绑定及https支持的配置步骤</a></p>
<p>我在操作过程中，始终无法通过github强制我的博客URL支持https协议，最终我是通过在CF为耳机域名指定强制https页面规则达到https支持的。</p>
<p>这样操作后会有个问题，强制导向https的博客页面有可能无法加载CSS、JS文件，这时您需要对之前我们手动添加的_config.yml文件进行修改。
（您既可以在github上修改后git pull，也可在本地修改后git push）</p>
<p>在文件中添加这么两行：</p>
<pre><code>root: /xxx.github.io
url: https://custom.url
（把xxx和custom.url分别替换为github默认页面url以及自定义的url）
</code></pre>
<p>之后保存文件git push或git pull即可让博客页面加载CSS、JS文件。</p>
<p><strong>到此为止一个个性化的Hugo博客就建好啦！</strong></p>
</div>
</article>
</main>
<footer class=site-footer>
<p class=copyright>© 2022 My Test Hugo Site</p>
<ul class=social-links>
<li>
<a class="icon icon-github" href=https://github.com/jmau111/hugo-theme-ava aria-label="Follow on GitHub"></a>
</li>
<li>
<a class="icon icon-twitter" href=https://twitter.com/gohugoio aria-label="Follow on Twitter"></a>
</li>
<li>
<a class="icon icon-dribbble" href=https://dribbble.com aria-label="Follow on Dribbble"></a>
</li>
<li>
<a class="icon icon-linkedin" href=https://linkedin.com aria-label="Follow on LinkedIn"></a>
</li>
<li>
<a class="icon icon-instagram" href=https://instagram.com aria-label="Follow on Instagram"></a>
</li>
</ul>
</footer>
<script src=https://chilisan.github.io/js/prefixfree.min.aaa4e8e903fe90f6f9da78ee095b81ae53e94812b5d99aefbf2a2c1b61af0b3c.js></script>
</body>
</html>